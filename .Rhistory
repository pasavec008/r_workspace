)
temp$Overall_Cond <- as.integer(temp$Overall_Cond, levels=c('Very_Poor', 'Poor', 'Below_Average', 'Fair', 'Average', 'Above_Average', 'Good', 'Very_Good', 'Excellent')
)
temp %>% select(Sale_Price, total_SF, Overall_Cond) %>%
mutate(Overall_Cond = as.integer(as.factor(Overall_Cond))) %>%
pairs()
temp %>% select(Sale_Price, total_SF, Overall_Cond) %>%
mutate(Overall_Cond = as.integer(as.factor(Overall_Cond))) %>%
cor()
temp
temp %>% select(Sale_Price, total_SF, Overall_Cond) %>%
mutate(Overall_Cond = as.integer(as.factor(Overall_Cond))) %>%
pairs()
temp %>% select(Sale_Price, total_SF, Overall_Cond) %>%
mutate(Overall_Cond = as.integer(as.factor(Overall_Cond))) %>%
cor()
temp %>% select(Sale_Price, total_SF, Overall_Cond) %>%
pairs()
temp %>% select(Sale_Price, total_SF, Overall_Cond) %>%
cor()
cleaned_data %>% select(Sale_Price, total_SF, Overall_Cond) %>%
mutate(Overall_Cond = as.integer(as.factor(Overall_Cond))) %>%
pairs()
cleaned_data %>% select(Sale_Price, total_SF, Overall_Cond) %>%
mutate(Overall_Cond = as.integer(as.factor(Overall_Cond))) %>%
cor()
data <- read.csv('data/Practicum.5.1.csv')
cleaned_data <- data %>%
pivot_wider(names_from = Area_SF, values_from = Value_SF)
cleaned_data %<>% mutate(Total_SF = Total_Bsmt_SF + First_Flr_SF + Second_Flr_SF + Open_Porch_SF)
cleaned_data
library(ggplot2)
# show without outliers to see how total_SF affects price
ggplot(cleaned_data[cleaned_data$total_SF < 7500, ], mapping = aes(x = total_SF, y = Sale_Price)) +
geom_point() +
geom_smooth()
# show without outliers to see how total_SF affects price
ggplot(cleaned_data[cleaned_data$Total_SF < 7500, ], mapping = aes(x = Total_SF, y = Sale_Price)) +
geom_point() +
geom_smooth()
data <- cleaned_data
#-----Preprocessing-----
data %<>%
mutate(Overall_Cond = as_factor(Overall_Cond))
panel.cor <- function(x,y, digits=2, prefix="", cex.cor){
usr <- par("usr")
on.exit(par(usr))
par(usr = c(0,1,0,1))
r <- abs(cor(x,y,use="complete.obs"))
txt <- format(c(r,0.123456789), digits = digits)[1]
txt <- paste0(prefix, txt,sep="")
if(missing(cex.cor)) cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * (1 + r) / 2)
}
panel.hist <- function(x, ...){
usr <- par("usr")
on.exit(par(usr))
par(usr = c(usr[1:2],0,1.5))
h <- hist(x, plot = FALSE)
breaks <- h$breaks
nB <- length(breaks)
y <- h$counts
y <- y/max(y)
rect(breaks[-nB], 0, breaks[-1], y, col="white",...)
}
panel.lm <- function(x,y,col = par("col"), bg = NA, pch = par("pch"),
cex = 1, col.smooth = "steelblue",...){
points(x,y,pch=pch, col=col, bg=bg, cex=cex)
abline(stats::lm(x ~ y), col = "steelblue", ...)
}
#-----Pair Plotting/Grammar of Graphics Facets-----
data %$%
pairs( ~ Total_SF + Overall_Cond + Sale_Price,
upper.panel= panel.cor,
diag.panel=panel.hist,
lower.panel=panel.smooth)
cleaned_data %>% select(Sale_Price, Total_SF, Overall_Cond) %>%
mutate(Overall_Cond = as.integer(as.factor(Overall_Cond))) %>%
pairs()
cleaned_data_split <- initial_split(cleaned_data, 0.8)
cleaned_data_split <- initial_split(cleaned_data, 0.8)
cleaned_data_train <- training(cleaned_data_split)
cleaned_data_test <- testing(cleaned_data_split)
library('parsnip')
help(parsnip)
help(set_engine)
linear_reg() %>% set_engine('lm') %>% translate()
linear_reg() %>% set_engine('lm')
model <- linear_reg() %>% set_engine('lm') %>% translate()
model <- linear_reg() %>% set_engine('lm')
model
cleaned_data_train
trained_model <- model %>% fit(Sale_Price ~ Total_SF + Overall_Cond, cleaned_data_train)
trained_model
summary(trained_model)
tidy(trained_model)
summary(tidy(trained_model))
tidy(trained_model)
trained_model
tidy(trained_model)
data <- read.csv('data/Practicum.5.1.csv')
data <- read.csv('data/Practicum.5.1.csv')
cleaned_data <- data %>%
pivot_wider(names_from = Area_SF, values_from = Value_SF)
cleaned_data %<>% mutate(Total_SF = Total_Bsmt_SF + First_Flr_SF + Second_Flr_SF + Open_Porch_SF)
cleaned_data
# show without outliers to see how total_SF affects price
ggplot(cleaned_data[cleaned_data$Total_SF < 7500, ], mapping = aes(x = Total_SF, y = Sale_Price)) +
geom_point() +
geom_smooth()
cleaned_data$Sale_Price <- log10(cleaned_data$Sale_Price)
hist(cleaned_data$Sale_Price)
qqnorm(cleaned_data$Sale_Price)
qqline(cleaned_data$Sale_Price)
cleaned_data %>% select(Sale_Price, Total_SF, Overall_Cond) %>%
mutate(Overall_Cond = as.integer(as.factor(Overall_Cond))) %>%
pairs()
cleaned_data %>% select(Sale_Price, Total_SF, Overall_Cond) %>%
mutate(Overall_Cond = as.integer(as.factor(Overall_Cond))) %>%
cor()
cleaned_data_split <- initial_split(cleaned_data, 0.8)
cleaned_data_train <- training(cleaned_data_split)
cleaned_data_test <- testing(cleaned_data_split)
library('parsnip')
model <- linear_reg() %>% set_engine('lm')
trained_model <- model %>% fit(Sale_Price ~ Total_SF + Overall_Cond, cleaned_data_train)
tidy(trained_model)
class(trained_model)
predict(trained_model, cleaned_data_test)
trained_model
cleaned_data_test
cleaned_data_test %>% select(Sale_Price) %>%
mutate(predicted = predict(trained_model, cleaned_data_test))
cleaned_data_test %>% select(Sale_Price) %>%
mutate(predicted = predict(trained_model, cleaned_data_test), residuals = Sale_Price - predict(trained_model, cleaned_data_test))
qqplot(trained_model)
qqplot(trained_model$fit)
autoplot(trained_model)
cleaned_data_train
cleaned_data_train[cleaned_data_train$ID = 1625,]
cleaned_data_train[cleaned_data_train$ID == 1625,]
# show without outliers to see how total_SF affects price
ggplot(cleaned_data[cleaned_data$Total_SF < 7500, ], mapping = aes(x = Total_SF, y = Sale_Price)) +
geom_point() +
geom_smooth()
autoplot(trained_model)
cleaned_data_train[cleaned_data_train$ID %in% c(1625, 1149),]
cleaned_data_train[!cleaned_data_train$ID %in% c(1625, 1149),]
cleaned_data_train[!cleaned_data_train$ID %in% c(1625, 1149, 83),]
cleaned_data_train[!cleaned_data_train$ID %in% c(1625, 1149, 2280),]
cleaned_data_test %>% select(Sale_Price) %>%
mutate(predicted = predict(trained_model, cleaned_data_test),
residuals = Sale_Price - predict(trained_model, cleaned_data_test))
glm()
data <- read.csv('data/Default.csv')
view(data)
help(if)
data
data$student[data$student == 0,]
data$student[data$student == 'No',]
data$student[data$student == 'No']
data$student <- data$student[data$student == 'No'] = 0
data
data$student[data$student == 'No'] <- 0
data
data$default <- ifelse(data$default == 'No', 0, 1)
data
data$student <- ifelse(data$student == 'No', 0, 1)
data
data$student
data <- read.csv('data/Default.csv')
data$default <- ifelse(data$default == 'No', 0, 1)
data$student <- ifelse(data$student == 'No', 0, 1)
data$student
data
hist(data$balance)
hist(data$income)
hist(data$balance)
qqnorm(data$balance)
qqline(data$balance)
qqnorm(data$balance[data$balance != 0])
qqline(data$balance[data$balance != 0])
data$ID <- 1:length(data)
data
length(data)
length(data$default)
data
row_number(data)
data$ID <- 1:length(data$default)
data
data %<>% select(ID, everything())
data
library(ggplot2)
ggplot(data, mapping = aes(balance)) +
geom_histogram()
ggplot(data, mapping = aes(balance)) +
geom_histogram() +
scale_fill_discrete(name = "default")
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram() +
scale_fill_discrete(name = "default")
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(position = 'identity') +
scale_fill_discrete(name = "default")
ggplot(data, aes(x = balance, fill = default)) +
geom_histogram(binwidth = 0.5, position = "identity", alpha = 0.5) +
scale_fill_manual(values = c("#619CFF", "#FF6666")) +
labs(x = "Value", y = "Count", fill = "Default")
ggplot(data, aes(x = balance, fill = default)) +
geom_histogram(position = "identity", alpha = 0.5) +
scale_fill_manual(values = c("#619CFF", "#FF6666")) +
labs(x = "Value", y = "Count", fill = "Default")
data <- read.csv('data/Default.csv')
data$default <- as.factor(ifelse(data$default == 'No', 0, 1))
data$default
data$student <- as.factor(ifelse(data$student == 'No', 0, 1))
hist(data$balance)
hist(data$income)
qqnorm(data$balance[data$balance != 0])
qqline(data$balance[data$balance != 0])
data$ID <- 1:length(data$default)
data %<>% select(ID, everything())
data
library(ggplot2)
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(position = 'identity') +
scale_fill_discrete(name = "default")
ggplot(data, mapping = aes(balance)) +
geom_histogram(position = 'identity') +
scale_fill_discrete(name = "default")
, fill = default
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(position = 'identity') +
scale_fill_discrete(name = "default")
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(position = 'identity')
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram()
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(alpha=0.6)
hist(data$balance)
hist(data$income)
hist(data$balance)
hist(log10(data$balance))
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(alpha=0.6)
plot(data)
autoplot(data)
ggplot(data, mapping = aes(balance, fill = default)) +
geom_smooth(alpha=0.6)
ggplot(data, mapping = aes(balance, fill = default)) +
geom_dotplot(alpha=0.6)
ggplot(data, mapping = aes(balance, fill = default)) +
geom_point(alpha=0.6)
ggplot(data, mapping = aes(default, balance, fill = default)) +
geom_point(alpha=0.6)
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(alpha=0.6)
autoplot(data)
plot(data)
ggplot(data, mapping = aes(default, balance, fill = default)) +
geom_point(alpha=0.6)
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(alpha=0.6)
autoplot(data)
summary(data$balance)
summary(data[data$default == 1,]$balance)
summary(data[data$default == 0,]$balance)
model <- glm(default ~ balance, data, family = 'binomial')
model
summary(model)
plot(model)
autoplot(model)
class(model)
view(model)
View(model)
model$coefficients
fit(model, data)
model$fitted.values
view(model$fitted.values)
data
data$predicted_default <- ifelse(model$fitted.values > 0.5, 1, 0)
data
data[data$predicted_default]
data[data$predicted_default,]
data[data$predicted_default == 1,]
new_data <- predict(model, newdata = tibble(balance = c(1000,1300,1700,2000,3000)))
new_data
new_data <- predict(model, newdata = tibble(balance = c(1000,1300,1700,2000,3000)), type = 'response')
new_data
type(new_data)
class(new_data)
new_data
ifelse(new_data > 0.8, 'defaulter', 'non-defaulter')
ifelse(new_data > 0.6, 'defaulter', 'non-defaulter')
ifelse(new_data > 0.6, 1, 0)
names(new_data) <- c(1000,1300,1700,2000,3000)
new_da
new_data
ifelse(new_data > 0.6, 'defaulter', 'non-defaulter')
ifelse(new_data > 0.6, 1, 0)
library(tidymodels)
library(tidyverse)
library(magrittr)
data <- read.csv('data/Default.csv')
view(data)
data$default <- as.factor(ifelse(data$default == 'No', 0, 1))
data$student <- as.factor(ifelse(data$student == 'No', 0, 1))
data
hist(log10(data$balance))
hist(data$income)
qqnorm(data$balance[data$balance != 0])
qqline(data$balance[data$balance != 0])
data$ID <- 1:length(data$default)
data %<>% select(ID, everything())
data
library(ggplot2)
#toto je daco
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(alpha=0.6)
autoplot(data)
ifelse(new_data > 0.6, 1, 0)
model.prediction
data <- read.csv('data/Default.csv')
data$default <- as.factor(ifelse(data$default == 'No', 0, 1))
data$student <- as.factor(ifelse(data$student == 'No', 0, 1))
data$ID <- 1:length(data$default)
data %<>% select(ID, everything())
library(ggplot2)
#toto je daco
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(alpha=0.6)
ggplot(data, mapping = aes(default, balance, fill = default)) +
geom_point(alpha=0.6)
model <- glm(default ~ balance, data, family = 'binomial')
model
summary(model)
view(model$fitted.values)
# here we can use any value as decision rule -> default 0.5
data$predicted_default <- ifelse(model$fitted.values > 0.5, 1, 0)
model.prediction
confusionMatrix(as_factor(data$predicted_default), as_factor(data$default), positive = "1")
library(caret)
install.packages('caret')
library(caret)
confusionMatrix(as_factor(data$predicted_default), as_factor(data$default), positive = "1")
data$predicted_default <- ifelse(model$fitted.values > 0.3, 1, 0)
confusionMatrix(as_factor(data$predicted_default), as_factor(data$default), positive = "1")
data$predicted_default <- ifelse(model$fitted.values > 0.2, 1, 0)
confusionMatrix(as_factor(data$predicted_default), as_factor(data$default), positive = "1")
data$predicted_default <- ifelse(model$fitted.values > 0.0, 1, 0)
confusionMatrix(as_factor(data$predicted_default), as_factor(data$default), positive = "1")
data$predicted_default <- ifelse(model$fitted.values > 0.001, 1, 0)
confusionMatrix(as_factor(data$predicted_default), as_factor(data$default), positive = "1")
ggplot(data, mapping = aes(balance, fill = predicted_default)) +
geom_histogram(alpha=0.6)
data
ggplot(data, mapping = aes(balance, fill = predicted_default)) +
geom_histogram(alpha=0.6)
#toto je daco
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(alpha=0.6)
ggplot(data, mapping = aes(balance, fill = as_factor(predicted_default))) +
geom_histogram(alpha=0.6)
data$predicted_default <- ifelse(model$fitted.values > 0.01, 1, 0)
confusionMatrix(as_factor(data$predicted_default), as_factor(data$default), positive = "1")
ggplot(data, mapping = aes(balance, fill = as_factor(predicted_default))) +
geom_histogram(alpha=0.6)
library(dplyr) #pipes
# load data
data <- read.csv('../data/Default.csv')
# load data
data <- read.csv('../data/Default.csv')
# load data
data <- read.csv('data/Default.csv')
# add ID to data using length and move ID column as first
data$ID <- 1:length(data$default)
data %>% select(income)
data %>% select(ID, everything())
#
data$default <- as.integer(as_factor(ifelse(data$default == 'No', 0, 1)))
#
data$default <- as.integer(as.factor(ifelse(data$default == 'No', 0, 1)))
data$default
pairs(data)
data$student <- as.factor(ifelse(data$student == 'No', 0, 1))
pairs(data)
cor(data)
data
data %>% select(ID, balance, income) %>%
mutate(balance_income_ratio = balance / income)
data
data %<>% select(ID, balance, income) %>%
mutate(balance_income_ratio = balance / income)
data
# Split data to train set and test set
data_split <- initial_split(data, 0.8)
### Libraries
# Main libraries for lot of things
library(tidyverse)
library(tidymodels)
library(magrittr) #pipes
library(dplyr) #pipes
# Plots
library(ggplot2)
# for autoplot of model
library(ggfortify)
# confusion matrix
library(caret)
# for lda() - linear discriminant analysis
library(MASS)
# for ROC - Area under curve is only important thing
library(ROCit)
# Split data to train set and test set
data_split <- initial_split(data, 0.8)
data_train <- training(data_split)
data_test <- testing(data_split)
data_train
data_test
library('tidyverse')
library('tidymodels')
library('magrittr')
library('ggplot2')
cric <- modeldata::crickets
cric
# Create a scatter plot with temperature on X and chirps on Y
ggplot(cric, aes(x = temp, y = rate, color = species)) +
geom_point() +
geom_smooth()
### Plots
ggplot(data, aes(x = income, y = balance, color = default)) +
geom_point() +
geom_smooth()
### Load data
data <- read.csv('data/Default.csv')
# Change Yes/No values to 1/0 and change it to factor (because some functions require factors)
data$default <- as.factor(ifelse(data$default == 'No', 0, 1))
data$student <- as.factor(ifelse(data$student == 'No', 0, 1))
### Plots
ggplot(data, aes(x = income, y = balance, color = default)) +
geom_point() +
geom_smooth()
### Plots
ggplot(data, aes(x = income, y = balance, color = default)) +
geom_point()
### Plots
# Create a scatter plot with temperature on X and chirps on Y
ggplot(modeldata::crickets, aes(x = temp, y = rate, color = species)) +
geom_point() +
geom_smooth()
### Plots
# Plot for dependency of 2 variables divided by color according to their classes
ggplot(modeldata::crickets, aes(x = temp, y = rate, color = species)) +
geom_point() +
geom_smooth()
# Basic analysis of data on plots
hist(data$balance)
qqnorm(data$balance)
qqline(data$balance)
data$balance
boxplot(data$balance)
boxplot(data$balance)
#toto je daco
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(alpha=0.6)
# Distribution of variable on two classes on one plot
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(alpha=0.6)
ggplot(data, mapping = aes(default, balance, fill = default)) +
geom_point(alpha=0.6)
# Distribution of variable on two classes on one plot
ggplot(data, mapping = aes(balance, color = default)) +
geom_histogram(alpha=0.6)
# Distribution of variable on two classes on one plot
ggplot(data, mapping = aes(balance, fill = default)) +
geom_histogram(alpha=0.6)
ggplot(data, mapping = aes(default, balance, fill = default)) +
geom_point(alpha=0.6)
### Plots
# Plot for dependency of 2 variables divided by color according to their classes
ggplot(modeldata::crickets, aes(x = temp, y = rate, color = species)) +
geom_point() +
geom_smooth()
### Plots
# Plot for dependency of 2 variables divided by color according to their classes
ggplot(modeldata::crickets, aes(x = temp, y = rate, fill = species)) +
geom_point() +
geom_smooth()
color
### Plots
# Plot for dependency of 2 variables divided by color according to their classes
ggplot(modeldata::crickets, aes(x = temp, y = rate, color = species)) +
geom_point() +
geom_smooth()
# Ordinary Linear Regression (OLR)
model <- lm(rate ~ temp + species, cric)
summary(model)
cor(data)
# predict data with model (data must have same structure [best to use train/test sets])
predict(model, cric[1:3,])
kk
# predict data with model (data must have same structure [best to use train/test sets])
kk <- cric[1:3,]
kk
kk %<>% select(!rate)
kk %<>% select(rate)
knitr::stitch('oznal/cheatsheet.R')
library(latexpdf)
knitr::stitch('oznal/cheatsheet.R')
library(pdflatex)
install.packages('pdflatex')
knitr::stitch('oznal/cheatsheet.R')
